import{S as ye,i as ve,s as ke,e as d,t as U,a as k,c as we,b as _e,d as p,f as g,g as i,m as ge,h as se,j as Ce,k as Ne,l as C,n as Le,o as Se,p as be,q as G,r as z,u as re,v as E,w as Te,x as Ae,y as Me,z as he}from"./index.534f2e7f.js";import{N as We}from"./Nav.6c89479b.js";import{f as ce,u as qe}from"./factory.fc96e4e7.js";import{w as Fe}from"./settings.f5ab2b6d.js";function fe(n,e,t){const l=n.slice();return l[28]=e[t],l}function He(n){let e,t,l,s,u,_,m,a,r,b,c,y,W,f,M,O,S,Z,D,$,x,P,X,ee,q,te,V,Y,le,F,h,H,R,I,J,N,w=n[5]==="hidden"&&ue(n),T=n[7]&&n[7].length>0&&pe(n);function ne(o,v){return o[2]?Be:je}let K=ne(n),j=K(n);function ie(o,v){return o[5]==="hidden"?Ge:Ee}let oe=ie(n),B=oe(n),Q=n[1],A=[];for(let o=0;o<Q.length;o+=1)A[o]=me(fe(n,Q,o));return{c(){w&&w.c(),e=k(),t=d("header"),l=d("form"),s=d("div"),u=d("label"),u.textContent="name",_=k(),m=d("input"),a=k(),r=d("div"),b=d("label"),b.textContent="symbol",c=k(),y=d("input"),W=k(),f=d("div"),M=d("label"),M.textContent="placeholder uri",O=k(),S=d("input"),Z=k(),D=d("div"),T&&T.c(),$=k(),j.c(),x=k(),P=d("div"),X=d("label"),X.textContent="total supply",ee=k(),q=d("input"),te=k(),V=d("div"),Y=d("label"),Y.textContent="base uri",le=k(),F=d("input"),h=k(),B.c(),R=k();for(let o=0;o<A.length;o+=1)A[o].c();I=_e(),p(m,"type","text"),p(m,"placeholder","name"),p(s,"class","item"),p(y,"type","text"),p(y,"placeholder","symbol"),p(r,"class","item"),p(S,"type","text"),p(S,"placeholder","placeholder uri (optional. if not set, a default image will be used)"),p(D,"class","file-holder"),p(f,"class","item"),p(q,"type","number"),p(q,"placeholder","total supply"),p(P,"class","item"),p(F,"type","text"),p(F,"placeholder","base uri (optional. you can set it later)"),p(V,"class","item"),p(l,"class",H="form "+n[5])},m(o,v){w&&w.m(o,v),g(o,e,v),g(o,t,v),i(t,l),i(l,s),i(s,u),i(s,_),i(s,m),E(m,n[0].name),i(l,a),i(l,r),i(r,b),i(r,c),i(r,y),E(y,n[0].symbol),i(l,W),i(l,f),i(f,M),i(f,O),i(f,S),E(S,n[0].placeholder),i(f,Z),i(f,D),T&&T.m(D,null),i(f,$),j.m(f,null),i(l,x),i(l,P),i(P,X),i(P,ee),i(P,q),E(q,n[0].supply),i(l,te),i(l,V),i(V,Y),i(V,le),i(V,F),E(F,n[0].base),i(l,h),B.m(l,null),g(o,R,v);for(let L=0;L<A.length;L+=1)A[L].m(o,v);g(o,I,v),J||(N=[G(m,"input",n[18]),G(y,"input",n[19]),G(S,"input",n[20]),G(q,"input",n[22]),G(F,"input",n[23]),G(l,"submit",Te(Ae(n[13])))],J=!0)},p(o,v){if(o[5]==="hidden"?w?w.p(o,v):(w=ue(o),w.c(),w.m(e.parentNode,e)):w&&(w.d(1),w=null),v&1&&m.value!==o[0].name&&E(m,o[0].name),v&1&&y.value!==o[0].symbol&&E(y,o[0].symbol),v&1&&S.value!==o[0].placeholder&&E(S,o[0].placeholder),o[7]&&o[7].length>0?T?T.p(o,v):(T=pe(o),T.c(),T.m(D,null)):T&&(T.d(1),T=null),K===(K=ne(o))&&j?j.p(o,v):(j.d(1),j=K(o),j&&(j.c(),j.m(f,null))),v&1&&be(q.value)!==o[0].supply&&E(q,o[0].supply),v&1&&F.value!==o[0].base&&E(F,o[0].base),oe===(oe=ie(o))&&B?B.p(o,v):(B.d(1),B=oe(o),B&&(B.c(),B.m(l,null))),v&32&&H!==(H="form "+o[5])&&p(l,"class",H),v&2){Q=o[1];let L;for(L=0;L<Q.length;L+=1){const ae=fe(o,Q,L);A[L]?A[L].p(ae,v):(A[L]=me(ae),A[L].c(),A[L].m(I.parentNode,I))}for(;L<A.length;L+=1)A[L].d(1);A.length=Q.length}},d(o){w&&w.d(o),o&&C(e),o&&C(t),T&&T.d(),j.d(),B.d(),o&&C(R),Me(A,o),o&&C(I),J=!1,he(N)}}}function Ie(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>loading...',p(e,"class","loading")},m(t,l){g(t,e,l)},p:z,d(t){t&&C(e)}}}function ue(n){let e,t,l,s;return{c(){e=d("div"),t=d("button"),t.textContent="+ create a contract",p(e,"class","top")},m(u,_){g(u,e,_),i(e,t),l||(s=G(t,"click",n[11]),l=!0)},p:z,d(u){u&&C(e),l=!1,s()}}}function pe(n){let e,t;return{c(){e=d("img"),p(e,"class","thumb"),re(e.src,t=n[7])||p(e,"src",t)},m(l,s){g(l,e,s)},p(l,s){s&128&&!re(e.src,t=l[7])&&p(e,"src",t)},d(l){l&&C(e)}}}function je(n){let e,t,l;return{c(){e=d("input"),p(e,"type","file"),p(e,"accept","image/*")},m(s,u){g(s,e,u),t||(l=[G(e,"change",n[21]),G(e,"change",n[14])],t=!0)},p:z,d(s){s&&C(e),t=!1,he(l)}}}function Be(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>uploading...',p(e,"class","loading")},m(t,l){g(t,e,l)},p:z,d(t){t&&C(e)}}}function Ee(n){let e,t,l,s,u;function _(r,b){return r[3]?Ve:Pe}let m=_(n),a=m(n);return{c(){e=d("div"),a.c(),t=k(),l=d("button"),l.textContent="close",p(e,"class","item")},m(r,b){g(r,e,b),a.m(e,null),i(e,t),i(e,l),s||(u=G(l,"click",n[12]),s=!0)},p(r,b){m!==(m=_(r))&&(a.d(1),a=m(r),a&&(a.c(),a.m(e,t)))},d(r){r&&C(e),a.d(),s=!1,u()}}}function Ge(n){return{c:z,m:z,p:z,d:z}}function Pe(n){let e;return{c(){e=d("input"),p(e,"type","submit"),e.value="Deploy"},m(t,l){g(t,e,l)},d(t){t&&C(e)}}}function Ve(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>deploying...',p(e,"class","loading")},m(t,l){g(t,e,l)},d(t){t&&C(e)}}}function de(n){let e,t=n[28].name+"",l,s,u=n[28].symbol+"",_,m;return{c(){e=d("h2"),l=U(t),s=U(" ("),_=U(u),m=U(")")},m(a,r){g(a,e,r),i(e,l),i(e,s),i(e,_),i(e,m)},p(a,r){r&2&&t!==(t=a[28].name+"")&&se(l,t),r&2&&u!==(u=a[28].symbol+"")&&se(_,u)},d(a){a&&C(e)}}}function me(n){let e,t,l,s=n[28].address+"",u,_,m,a=n[28].name&&de(n);return{c(){e=d("a"),a&&a.c(),t=k(),l=d("div"),u=U(s),_=k(),p(e,"class","item"),p(e,"href",m="/contract/#"+n[28].address)},m(r,b){g(r,e,b),a&&a.m(e,null),i(e,t),i(e,l),i(l,u),i(e,_)},p(r,b){r[28].name?a?a.p(r,b):(a=de(r),a.c(),a.m(e,t)):a&&(a.d(1),a=null),b&2&&s!==(s=r[28].address+"")&&se(u,s),b&2&&m!==(m="/contract/#"+r[28].address)&&p(e,"href",m)},d(r){r&&C(e),a&&a.d()}}}function ze(n){let e,t,l,s,u,_,m;s=new We({props:{v1:n[16],v2:n[15],network:n[10],account:n[9]}});function a(c,y){return c[4]?Ie:He}let r=a(n),b=r(n);return{c(){e=d("div"),t=U(n[8]),l=k(),we(s.$$.fragment),u=k(),b.c(),_=_e(),p(e,"class","error")},m(c,y){g(c,e,y),i(e,t),g(c,l,y),ge(s,c,y),g(c,u,y),b.m(c,y),g(c,_,y),m=!0},p(c,[y]){(!m||y&256)&&se(t,c[8]);const W={};y&1024&&(W.network=c[10]),y&512&&(W.account=c[9]),s.$set(W),r===(r=a(c))&&b?b.p(c,y):(b.d(1),b=r(c),b&&(b.c(),b.m(_.parentNode,_)))},i(c){m||(Ce(s.$$.fragment,c),m=!0)},o(c){Ne(s.$$.fragment,c),m=!1},d(c){c&&C(e),c&&C(l),Le(s,c),c&&C(u),b.d(c),c&&C(_)}}}function De(n,e,t){let{version:l}=e,s,u,_=[],m=!1,a,r,b="hidden",c=[],y="",W="",f={name:"",symbol:"",placeholder:"",supply:"",base:""},M,O,S;const Z=async()=>{t(4,r=!0),t(9,M=await u.account);let h=await S.getPastEvents("CollectionAdded",{filter:{receiver:M},fromBlock:0,toBlock:"latest"}).then(N=>N.map(w=>w.returnValues.collection)),H=Array.from(new Set(h)),R=[];const I=new F0;for(let N of H)console.log("address",N),R.push({address:N,name:"fetching...",symbol:""});t(1,_=R),t(4,r=!1);let J=[];for(let N=0;N<_.length;N++){let w=_[N].address;if(await I.init({web3:s,contract:w}),(await I.api.owner().call()).toLowerCase()!==M.toLowerCase()){console.log("remove at",N),J.push(N);continue}else{let ne=await I.api.name().call(),K=await I.api.symbol().call();t(1,_[N].name=ne,_),t(1,_[N].symbol=K,_)}}for(let N of J)_.splice(N,1)},D=()=>{t(5,b="")},$=()=>{t(5,b="hidden")},x=async()=>{t(3,a=!0),console.log("payload",f);try{await u.disconnect();let h=await u.connect();s=new Web3(h),S=await ce(s,l),t(10,O=S.$network);let H=await S.methods.genesis(M,f.name,f.symbol,{placeholder:f.placeholder,base:f.base,supply:f.supply,permanent:!1}).send({from:M});console.log("tx",H),t(3,a=!1),location.href="/contract/#"+H.events.CollectionAdded.returnValues.collection}catch(h){t(8,W=h.message)}},P=async()=>{if(c.length>0){t(2,m=!0);try{let h=await qe(c[0]);t(0,f.placeholder="ipfs://"+h,f)}catch{confirm("NFT.STORAGE api key needed. Go to the config page and set it first")&&window.open("/config/")}t(2,m=!1)}};let X=l==="v2"?"selected":"",ee=l==="v1"?"selected":"";Se(async()=>{try{u=new Superprovider({walletconnect:Fe});let h=await u.current();h||(h=await u.connect()),t(9,M=u.account),s=new Web3(h),S=await ce(s,l),t(10,O=S.$network),await Z()}catch(h){t(8,W=h.message)}});function q(){f.name=this.value,t(0,f)}function te(){f.symbol=this.value,t(0,f)}function V(){f.placeholder=this.value,t(0,f)}function Y(){c=this.files,t(6,c)}function le(){f.supply=be(this.value),t(0,f)}function F(){f.base=this.value,t(0,f)}return n.$$set=h=>{"version"in h&&t(17,l=h.version)},n.$$.update=()=>{n.$$.dirty&1&&f&&f.placeholder&&fetch("https://ipfs.io/ipfs/"+f.placeholder.replace("ipfs://","")).then(h=>h.json()).then(h=>{h.image.startsWith("ipfs://")?t(7,y="https://ipfs.io/ipfs/"+h.image.replace("ipfs://","")):h.image.startsWith("http")&&t(7,y=h.image)})},[f,_,m,a,r,b,c,y,W,M,O,D,$,x,P,X,ee,l,q,te,V,Y,le,F]}class Qe extends ye{constructor(e){super(),ve(this,e,De,ze,ke,{version:17})}}export{Qe as I};
