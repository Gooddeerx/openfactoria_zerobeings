import{S as he,i as ve,s as ye,e as d,t as B,a as y,c as ke,b as me,d as u,f as C,g as o,m as ge,h as Q,j as we,k as Ce,l as N,n as Ne,o as Te,p as _e,q as z,r as re,u as j,v as Ae,w as Le,x as Se,y as be,z as R}from"./index.ab445ea7.js";import{N as Fe}from"./Nav.50a4621f.js";import{u as Ie,f as Me}from"./factory.2ca8d628.js";import{w as qe}from"./settings.f5ab2b6d.js";function ce(n,e,l){const t=n.slice();return t[28]=e[l],t}function Ee(n){let e,l,t,i,h,b,p,c,a,f,r,_,L,m,I,X,F,x,P,ee,le,G,Y,te,M,ne,O,Z,se,q,v,V,U,E,J,g,w=n[5]==="hidden"&&fe(n),T=n[7]&&n[7].length>0&&ue(n);function $(s,k){return s[2]?je:We}let D=$(n),H=D(n);function ie(s,k){return s[5]==="hidden"?Be:ze}let oe=ie(n),W=oe(n),K=n[1],S=[];for(let s=0;s<K.length;s+=1)S[s]=de(ce(n,K,s));return{c(){w&&w.c(),e=y(),l=d("header"),t=d("form"),i=d("div"),h=d("label"),h.textContent="name",b=y(),p=d("input"),c=y(),a=d("div"),f=d("label"),f.textContent="symbol",r=y(),_=d("input"),L=y(),m=d("div"),I=d("label"),I.textContent="placeholder uri",X=y(),F=d("input"),x=y(),P=d("div"),T&&T.c(),ee=y(),H.c(),le=y(),G=d("div"),Y=d("label"),Y.textContent="total supply",te=y(),M=d("input"),ne=y(),O=d("div"),Z=d("label"),Z.textContent="base uri",se=y(),q=d("input"),v=y(),W.c(),U=y();for(let s=0;s<S.length;s+=1)S[s].c();E=me(),u(p,"type","text"),u(p,"placeholder","name"),u(i,"class","item"),u(_,"type","text"),u(_,"placeholder","symbol"),u(a,"class","item"),u(F,"type","text"),u(F,"placeholder","placeholder uri (optional. if not set, a default image will be used)"),u(P,"class","file-holder"),u(m,"class","item"),u(M,"type","number"),u(M,"placeholder","total supply"),u(G,"class","item"),u(q,"type","text"),u(q,"placeholder","base uri (optional. you can set it later)"),u(O,"class","item"),u(t,"class",V="form "+n[5]+" svelte-nkiebh"),u(l,"class","svelte-nkiebh")},m(s,k){w&&w.m(s,k),C(s,e,k),C(s,l,k),o(l,t),o(t,i),o(i,h),o(i,b),o(i,p),j(p,n[0].name),o(t,c),o(t,a),o(a,f),o(a,r),o(a,_),j(_,n[0].symbol),o(t,L),o(t,m),o(m,I),o(m,X),o(m,F),j(F,n[0].placeholder),o(m,x),o(m,P),T&&T.m(P,null),o(m,ee),H.m(m,null),o(t,le),o(t,G),o(G,Y),o(G,te),o(G,M),j(M,n[0].supply),o(t,ne),o(t,O),o(O,Z),o(O,se),o(O,q),j(q,n[0].base),o(t,v),W.m(t,null),C(s,U,k);for(let A=0;A<S.length;A+=1)S[A].m(s,k);C(s,E,k),J||(g=[z(p,"input",n[18]),z(_,"input",n[19]),z(F,"input",n[20]),z(M,"input",n[22]),z(q,"input",n[23]),z(t,"submit",Ae(Le(n[13])))],J=!0)},p(s,k){if(s[5]==="hidden"?w?w.p(s,k):(w=fe(s),w.c(),w.m(e.parentNode,e)):w&&(w.d(1),w=null),k&1&&p.value!==s[0].name&&j(p,s[0].name),k&1&&_.value!==s[0].symbol&&j(_,s[0].symbol),k&1&&F.value!==s[0].placeholder&&j(F,s[0].placeholder),s[7]&&s[7].length>0?T?T.p(s,k):(T=ue(s),T.c(),T.m(P,null)):T&&(T.d(1),T=null),D===(D=$(s))&&H?H.p(s,k):(H.d(1),H=D(s),H&&(H.c(),H.m(m,null))),k&1&&_e(M.value)!==s[0].supply&&j(M,s[0].supply),k&1&&q.value!==s[0].base&&j(q,s[0].base),oe===(oe=ie(s))&&W?W.p(s,k):(W.d(1),W=oe(s),W&&(W.c(),W.m(t,null))),k&32&&V!==(V="form "+s[5]+" svelte-nkiebh")&&u(t,"class",V),k&2){K=s[1];let A;for(A=0;A<K.length;A+=1){const ae=ce(s,K,A);S[A]?S[A].p(ae,k):(S[A]=de(ae),S[A].c(),S[A].m(E.parentNode,E))}for(;A<S.length;A+=1)S[A].d(1);S.length=K.length}},d(s){w&&w.d(s),s&&N(e),s&&N(l),T&&T.d(),H.d(),W.d(),s&&N(U),Se(S,s),s&&N(E),J=!1,be(g)}}}function He(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>loading...',u(e,"class","loading")},m(l,t){C(l,e,t)},p:R,d(l){l&&N(e)}}}function fe(n){let e,l,t,i,h,b,p,c,a,f,r;return{c(){e=d("div"),l=d("div"),t=d("div"),i=B("ACCOUNT: "),h=B(n[10]),b=y(),p=B(n[9]),c=y(),a=d("button"),a.textContent="+ create a collection",u(l,"class","network svelte-nkiebh"),u(a,"class","svelte-nkiebh"),u(e,"class","top svelte-nkiebh")},m(_,L){C(_,e,L),o(e,l),o(l,t),o(t,i),o(t,h),o(t,b),o(t,p),o(e,c),o(e,a),f||(r=z(a,"click",n[11]),f=!0)},p(_,L){L&1024&&Q(h,_[10]),L&512&&Q(p,_[9])},d(_){_&&N(e),f=!1,r()}}}function ue(n){let e,l;return{c(){e=d("img"),u(e,"class","thumb"),re(e.src,l=n[7])||u(e,"src",l)},m(t,i){C(t,e,i)},p(t,i){i&128&&!re(e.src,l=t[7])&&u(e,"src",l)},d(t){t&&N(e)}}}function We(n){let e,l,t;return{c(){e=d("input"),u(e,"type","file"),u(e,"accept","image/*")},m(i,h){C(i,e,h),l||(t=[z(e,"change",n[21]),z(e,"change",n[14])],l=!0)},p:R,d(i){i&&N(e),l=!1,be(t)}}}function je(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>uploading...',u(e,"class","loading")},m(l,t){C(l,e,t)},p:R,d(l){l&&N(e)}}}function ze(n){let e,l,t,i,h;function b(a,f){return a[3]?Oe:Ge}let p=b(n),c=p(n);return{c(){e=d("div"),c.c(),l=y(),t=d("button"),t.textContent="close",u(t,"class","svelte-nkiebh"),u(e,"class","item")},m(a,f){C(a,e,f),c.m(e,null),o(e,l),o(e,t),i||(h=z(t,"click",n[12]),i=!0)},p(a,f){p!==(p=b(a))&&(c.d(1),c=p(a),c&&(c.c(),c.m(e,l)))},d(a){a&&N(e),c.d(),i=!1,h()}}}function Be(n){return{c:R,m:R,p:R,d:R}}function Ge(n){let e;return{c(){e=d("input"),u(e,"type","submit"),e.value="Deploy"},m(l,t){C(l,e,t)},d(l){l&&N(e)}}}function Oe(n){let e;return{c(){e=d("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>deploying...',u(e,"class","loading")},m(l,t){C(l,e,t)},d(l){l&&N(e)}}}function pe(n){let e,l,t,i=n[28].name+"",h,b,p=n[28].symbol+"",c,a;return{c(){e=d("h2"),l=d("i"),t=y(),h=B(i),b=B(" ("),c=B(p),a=B(")"),u(l,"class","fa-solid fa-caret-up")},m(f,r){C(f,e,r),o(e,l),o(e,t),o(e,h),o(e,b),o(e,c),o(e,a)},p(f,r){r&2&&i!==(i=f[28].name+"")&&Q(h,i),r&2&&p!==(p=f[28].symbol+"")&&Q(c,p)},d(f){f&&N(e)}}}function de(n){let e,l,t,i=n[28].address+"",h,b,p,c=n[28].name&&pe(n);return{c(){e=d("a"),c&&c.c(),l=y(),t=d("div"),h=B(i),b=y(),u(e,"class","item"),u(e,"href",p="/contract/#"+n[28].address)},m(a,f){C(a,e,f),c&&c.m(e,null),o(e,l),o(e,t),o(t,h),o(e,b)},p(a,f){a[28].name?c?c.p(a,f):(c=pe(a),c.c(),c.m(e,l)):c&&(c.d(1),c=null),f&2&&i!==(i=a[28].address+"")&&Q(h,i),f&2&&p!==(p="/contract/#"+a[28].address)&&u(e,"href",p)},d(a){a&&N(e),c&&c.d()}}}function Pe(n){let e,l,t,i,h,b,p;i=new Fe({props:{v1:n[16],v2:n[15],network:n[10],account:n[9]}});function c(r,_){return r[4]?He:Ee}let a=c(n),f=a(n);return{c(){e=d("div"),l=B(n[8]),t=y(),ke(i.$$.fragment),h=y(),f.c(),b=me(),u(e,"class","error")},m(r,_){C(r,e,_),o(e,l),C(r,t,_),ge(i,r,_),C(r,h,_),f.m(r,_),C(r,b,_),p=!0},p(r,[_]){(!p||_&256)&&Q(l,r[8]);const L={};_&1024&&(L.network=r[10]),_&512&&(L.account=r[9]),i.$set(L),a===(a=c(r))&&f?f.p(r,_):(f.d(1),f=a(r),f&&(f.c(),f.m(b.parentNode,b)))},i(r){p||(we(i.$$.fragment,r),p=!0)},o(r){Ce(i.$$.fragment,r),p=!1},d(r){r&&N(e),r&&N(t),Ne(i,r),r&&N(h),f.d(r),r&&N(b)}}}function Ve(n,e,l){let{version:t}=e,i,h,b=[],p=!1,c,a,f="hidden",r=[],_="",L="",m={name:"",symbol:"",placeholder:"",supply:"",base:""},I,X,F;const x=async()=>{l(4,a=!0),l(9,I=await h.account);let v=await F.getPastEvents("CollectionAdded",{filter:{receiver:I},fromBlock:0,toBlock:"latest"}).then(g=>g.map(w=>w.returnValues.collection)),V=Array.from(new Set(v)),U=[];const E=new F0;for(let g of V)console.log("address",g),U.push({address:g,name:"fetching...",symbol:""});l(1,b=U),l(4,a=!1);let J=[];for(let g=0;g<b.length;g++){console.log("FEtching",g);let w=b[g].address;await E.init({web3:i,contract:w}),console.log("initialized");let T=await E.api.owner().call();if(console.log("owner",T),T.toLowerCase()!==I.toLowerCase()){console.log("remove at",g),J.push(g);continue}else{let $=await E.api.name().call(),D=await E.api.symbol().call();console.log("name, symbol",$,D),l(1,b[g].name=$,b),l(1,b[g].symbol=D,b),l(1,b)}}for(let g of J)b.splice(g,1)},P=()=>{l(5,f="")},ee=()=>{l(5,f="hidden")},le=async()=>{l(3,c=!0),console.log("payload",m);try{let v=await F.methods.genesis(I,m.name,m.symbol,{placeholder:m.placeholder,base:m.base,supply:m.supply,permanent:!1}).send({from:I});console.log("tx",v),l(3,c=!1),location.href="/contract/#"+v.events.CollectionAdded.returnValues.collection}catch(v){l(8,L=v.message)}},G=async()=>{if(r.length>0){l(2,p=!0);try{let v=await Ie(r[0]);l(0,m.placeholder="ipfs://"+v,m)}catch{confirm("NFT.STORAGE api key needed. Go to the config page and set it first")&&window.open("/config/")}l(2,p=!1)}};let Y=t==="v2"?"selected":"",te=t==="v1"?"selected":"";Te(async()=>{try{h=new Superprovider({walletconnect:qe});let v=await h.current();v||(v=await h.connect()),l(9,I=h.account),i=new Web3(v),F=await Me(i,t),l(10,X=F.$network),await x()}catch(v){l(8,L=v.message)}});function M(){m.name=this.value,l(0,m)}function ne(){m.symbol=this.value,l(0,m)}function O(){m.placeholder=this.value,l(0,m)}function Z(){r=this.files,l(6,r)}function se(){m.supply=_e(this.value),l(0,m)}function q(){m.base=this.value,l(0,m)}return n.$$set=v=>{"version"in v&&l(17,t=v.version)},n.$$.update=()=>{n.$$.dirty&1&&m&&m.placeholder&&fetch("https://ipfs.io/ipfs/"+m.placeholder.replace("ipfs://","")).then(v=>v.json()).then(v=>{v.image.startsWith("ipfs://")?l(7,_="https://ipfs.io/ipfs/"+v.image.replace("ipfs://","")):v.image.startsWith("http")&&l(7,_=v.image)})},[m,b,p,c,a,f,r,_,L,I,X,P,ee,le,G,Y,te,t,M,ne,O,Z,se,q]}class Ke extends he{constructor(e){super(),ve(this,e,Ve,Pe,ye,{version:17})}}export{Ke as I};
