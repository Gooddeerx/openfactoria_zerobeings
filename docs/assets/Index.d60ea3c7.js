import{S as he,i as ye,s as ve,N as ke,e as p,t as Q,a as w,c as we,b as me,d as f,f as C,g as i,m as ge,h as se,j as Ce,k as qe,l as q,n as Ae,o as Le,p as _e,q as j,r as D,u as re,v as W,w as Ne,x as Me,y as He,z as be}from"./Nav.2716bc71.js";import{u as Ie,f as Se}from"./factory.98fda954.js";function ce(n,e,t){const l=n.slice();return l[27]=e[t],l}function Te(n){let e,t,l,a,c,h,d,o,r,m,u,y,_,L,J,E,I,Z,G,$,x,F,R,ee,S,te,P,U,le,v,B,H,X,V,z,Y,b=n[5]==="hidden"&&ue(n),g=n[7]&&n[7].length>0&&fe(n);function oe(s,k){return s[2]?Be:je}let K=oe(n),M=K(n);function ie(s,k){return s[5]==="hidden"?Pe:Fe}let ne=ie(n),T=ne(n),O=n[1],N=[];for(let s=0;s<O.length;s+=1)N[s]=de(ce(n,O,s));return{c(){b&&b.c(),e=w(),t=p("header"),l=p("form"),a=p("div"),c=p("label"),c.textContent="name",h=w(),d=p("input"),o=w(),r=p("div"),m=p("label"),m.textContent="symbol",u=w(),y=p("input"),_=w(),L=p("div"),J=p("label"),J.textContent="placeholder uri",E=w(),I=p("input"),Z=w(),G=p("div"),g&&g.c(),$=w(),M.c(),x=w(),F=p("div"),R=p("label"),R.textContent="total supply",ee=w(),S=p("input"),te=w(),P=p("div"),U=p("label"),U.textContent="base uri",le=w(),v=p("input"),B=w(),T.c(),X=w();for(let s=0;s<N.length;s+=1)N[s].c();V=me(),f(d,"type","text"),f(d,"placeholder","name"),f(a,"class","item"),f(y,"type","text"),f(y,"placeholder","symbol"),f(r,"class","item"),f(I,"type","text"),f(I,"placeholder","placeholder uri (optional. if not set, a default image will be used)"),f(G,"class","file-holder"),f(L,"class","item"),f(S,"type","number"),f(S,"placeholder","total supply"),f(F,"class","item"),f(v,"type","text"),f(v,"placeholder","base uri (optional. you can set it later)"),f(P,"class","item"),f(l,"class",H="form "+n[5])},m(s,k){b&&b.m(s,k),C(s,e,k),C(s,t,k),i(t,l),i(l,a),i(a,c),i(a,h),i(a,d),W(d,n[0].name),i(l,o),i(l,r),i(r,m),i(r,u),i(r,y),W(y,n[0].symbol),i(l,_),i(l,L),i(L,J),i(L,E),i(L,I),W(I,n[0].placeholder),i(L,Z),i(L,G),g&&g.m(G,null),i(L,$),M.m(L,null),i(l,x),i(l,F),i(F,R),i(F,ee),i(F,S),W(S,n[0].supply),i(l,te),i(l,P),i(P,U),i(P,le),i(P,v),W(v,n[0].base),i(l,B),T.m(l,null),C(s,X,k);for(let A=0;A<N.length;A+=1)N[A].m(s,k);C(s,V,k),z||(Y=[j(d,"input",n[18]),j(y,"input",n[19]),j(I,"input",n[20]),j(S,"input",n[22]),j(v,"input",n[23]),j(l,"submit",Ne(Me(n[13])))],z=!0)},p(s,k){if(s[5]==="hidden"?b?b.p(s,k):(b=ue(s),b.c(),b.m(e.parentNode,e)):b&&(b.d(1),b=null),k&1&&d.value!==s[0].name&&W(d,s[0].name),k&1&&y.value!==s[0].symbol&&W(y,s[0].symbol),k&1&&I.value!==s[0].placeholder&&W(I,s[0].placeholder),s[7]&&s[7].length>0?g?g.p(s,k):(g=fe(s),g.c(),g.m(G,null)):g&&(g.d(1),g=null),K===(K=oe(s))&&M?M.p(s,k):(M.d(1),M=K(s),M&&(M.c(),M.m(L,null))),k&1&&_e(S.value)!==s[0].supply&&W(S,s[0].supply),k&1&&v.value!==s[0].base&&W(v,s[0].base),ne===(ne=ie(s))&&T?T.p(s,k):(T.d(1),T=ne(s),T&&(T.c(),T.m(l,null))),k&32&&H!==(H="form "+s[5])&&f(l,"class",H),k&2){O=s[1];let A;for(A=0;A<O.length;A+=1){const ae=ce(s,O,A);N[A]?N[A].p(ae,k):(N[A]=de(ae),N[A].c(),N[A].m(V.parentNode,V))}for(;A<N.length;A+=1)N[A].d(1);N.length=O.length}},d(s){b&&b.d(s),s&&q(e),s&&q(t),g&&g.d(),M.d(),T.d(),s&&q(X),He(N,s),s&&q(V),z=!1,be(Y)}}}function We(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>loading...',f(e,"class","loading")},m(t,l){C(t,e,l)},p:D,d(t){t&&q(e)}}}function ue(n){let e,t,l,a;return{c(){e=p("div"),t=p("button"),t.textContent="+ create a contract",f(e,"class","top")},m(c,h){C(c,e,h),i(e,t),l||(a=j(t,"click",n[11]),l=!0)},p:D,d(c){c&&q(e),l=!1,a()}}}function fe(n){let e,t;return{c(){e=p("img"),f(e,"class","thumb"),re(e.src,t=n[7])||f(e,"src",t)},m(l,a){C(l,e,a)},p(l,a){a&128&&!re(e.src,t=l[7])&&f(e,"src",t)},d(l){l&&q(e)}}}function je(n){let e,t,l;return{c(){e=p("input"),f(e,"type","file"),f(e,"accept","image/*")},m(a,c){C(a,e,c),t||(l=[j(e,"change",n[21]),j(e,"change",n[14])],t=!0)},p:D,d(a){a&&q(e),t=!1,be(l)}}}function Be(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>uploading...',f(e,"class","loading")},m(t,l){C(t,e,l)},p:D,d(t){t&&q(e)}}}function Fe(n){let e,t,l,a,c;function h(r,m){return r[3]?ze:Ve}let d=h(n),o=d(n);return{c(){e=p("div"),o.c(),t=w(),l=p("button"),l.textContent="close",f(e,"class","item")},m(r,m){C(r,e,m),o.m(e,null),i(e,t),i(e,l),a||(c=j(l,"click",n[12]),a=!0)},p(r,m){d!==(d=h(r))&&(o.d(1),o=d(r),o&&(o.c(),o.m(e,t)))},d(r){r&&q(e),o.d(),a=!1,c()}}}function Pe(n){return{c:D,m:D,p:D,d:D}}function Ve(n){let e;return{c(){e=p("input"),f(e,"type","submit"),e.value="Deploy"},m(t,l){C(t,e,l)},d(t){t&&q(e)}}}function ze(n){let e;return{c(){e=p("div"),e.innerHTML='<i class="fa-solid fa-circle-notch fa-spin"></i><br/>deploying...',f(e,"class","loading")},m(t,l){C(t,e,l)},d(t){t&&q(e)}}}function pe(n){let e,t=n[27].name+"",l,a,c=n[27].symbol+"",h,d;return{c(){e=p("h2"),l=Q(t),a=Q(" ("),h=Q(c),d=Q(")")},m(o,r){C(o,e,r),i(e,l),i(e,a),i(e,h),i(e,d)},p(o,r){r&2&&t!==(t=o[27].name+"")&&se(l,t),r&2&&c!==(c=o[27].symbol+"")&&se(h,c)},d(o){o&&q(e)}}}function de(n){let e,t,l,a=n[27].address+"",c,h,d,o=n[27].name&&pe(n);return{c(){e=p("a"),o&&o.c(),t=w(),l=p("div"),c=Q(a),h=w(),f(e,"class","item"),f(e,"href",d="/contract/#"+n[27].address)},m(r,m){C(r,e,m),o&&o.m(e,null),i(e,t),i(e,l),i(l,c),i(e,h)},p(r,m){r[27].name?o?o.p(r,m):(o=pe(r),o.c(),o.m(e,t)):o&&(o.d(1),o=null),m&2&&a!==(a=r[27].address+"")&&se(c,a),m&2&&d!==(d="/contract/#"+r[27].address)&&f(e,"href",d)},d(r){r&&q(e),o&&o.d()}}}function De(n){let e,t,l,a,c,h,d;a=new ke({props:{v1:n[16],v2:n[15],network:n[10],account:n[9]}});function o(u,y){return u[4]?We:Te}let r=o(n),m=r(n);return{c(){e=p("div"),t=Q(n[8]),l=w(),we(a.$$.fragment),c=w(),m.c(),h=me(),f(e,"class","error")},m(u,y){C(u,e,y),i(e,t),C(u,l,y),ge(a,u,y),C(u,c,y),m.m(u,y),C(u,h,y),d=!0},p(u,[y]){(!d||y&256)&&se(t,u[8]);const _={};y&1024&&(_.network=u[10]),y&512&&(_.account=u[9]),a.$set(_),r===(r=o(u))&&m?m.p(u,y):(m.d(1),m=r(u),m&&(m.c(),m.m(h.parentNode,h)))},i(u){d||(Ce(a.$$.fragment,u),d=!0)},o(u){qe(a.$$.fragment,u),d=!1},d(u){u&&q(e),u&&q(l),Ae(a,u),u&&q(c),m.d(u),u&&q(h)}}}function Ee(n,e,t){let{version:l}=e,a=new Web3(window.ethereum),c=[],h=!1,d,o,r="hidden",m=[],u="",y="",_={name:"",symbol:"",placeholder:"",supply:"",base:""},L,J,E;const I=async()=>{t(4,o=!0);let B=(await window.ethereum.send("eth_requestAccounts")).result[0];t(9,L=B),console.log("current_account",L);let H=await E.getPastEvents("CollectionAdded",{filter:{receiver:B},fromBlock:0,toBlock:"latest"}).then(b=>b.map(g=>g.returnValues.collection)),X=Array.from(new Set(H)),V=[];const z=new F0;for(let b of X)console.log("address",b),V.push({address:b,name:"fetching...",symbol:""});t(1,c=V),t(4,o=!1);let Y=[];for(let b=0;b<c.length;b++){let g=c[b].address;if(await z.init({web3:a,contract:g}),(await z.api.owner().call()).toLowerCase()!==B.toLowerCase()){console.log("remove at",b),Y.push(b);continue}else{let K=await z.api.name().call(),M=await z.api.symbol().call();t(1,c[b].name=K,c),t(1,c[b].symbol=M,c)}}for(let b of Y)c.splice(b,1)},Z=()=>{t(5,r="")},G=()=>{t(5,r="hidden")},$=async()=>{t(3,d=!0),console.log("payload",_);let B=(await window.ethereum.send("eth_requestAccounts")).result[0];try{let H=await E.methods.genesis(B,_.name,_.symbol,{placeholder:_.placeholder,base:_.base,supply:_.supply,permanent:!1}).send({from:B});console.log("tx",H),t(3,d=!1),location.href="/contract/#"+H.events.CollectionAdded.returnValues.collection}catch(H){t(8,y=H.message)}},x=async()=>{if(m.length>0){t(2,h=!0);let v=await Ie(m[0]);t(0,_.placeholder="ipfs://"+v,_),t(2,h=!1)}};let F=l==="v2"?"selected":"",R=l==="v1"?"selected":"";o=!0,Le(async()=>{E=await Se(a,l),t(10,J=E.$network),await I()});function ee(){_.name=this.value,t(0,_)}function S(){_.symbol=this.value,t(0,_)}function te(){_.placeholder=this.value,t(0,_)}function P(){m=this.files,t(6,m)}function U(){_.supply=_e(this.value),t(0,_)}function le(){_.base=this.value,t(0,_)}return n.$$set=v=>{"version"in v&&t(17,l=v.version)},n.$$.update=()=>{n.$$.dirty&1&&_&&_.placeholder&&fetch("https://ipfs.io/ipfs/"+_.placeholder.replace("ipfs://","")).then(v=>v.json()).then(v=>{v.image.startsWith("ipfs://")?t(7,u="https://ipfs.io/ipfs/"+v.image.replace("ipfs://","")):v.image.startsWith("http")&&t(7,u=v.image)})},[_,c,h,d,o,r,m,u,y,L,J,Z,G,$,x,F,R,l,ee,S,te,P,U,le]}class Ke extends he{constructor(e){super(),ye(this,e,Ee,De,ve,{version:17})}}export{Ke as I};
